# HTTP 완벽 가이드 (HTTP: The Definitive Guide)

- HTTP를 이해하는 것이 중요한가?  
  - 월드와이드 웹을 지탱하는 가장 중요한 기술 두 가지는 HTML과 HTTP이다. 이 두 기술은 팀버너스-리가 웹을 발명할 때 함께 만들어졌다.  
  - 이 둘 중 하나라도 빠지면 웹은 성립하지 않으며, 한편으로 이 둘만 있어도 어떻게든 웹은 성립할 수 있다.  
- HTTP를 이해한다는 것은 웹이 어떻게 동작하는지 이해한다는 것이며, 이를 깊이 이해하면 웹 프로그래밍을 하면서, 웹 서버를 조작하면서, 그리고 네트워크를 관리하면서 정확한 근거에 기반한 올바른 기술적 판단을 내려야 할 때 큰 도움이 된다.

## 1. HTTP

- 신뢰성 있는 데이터 전송 프로토콜을 사용하기 때문에 전송 중 손상되거나 꼬이지 않음을 보장한다.

### 1.2 웹클라이언트 서버

- 클라이언트 요청 → 서버 확인 → 서버 응답 → 클라이언트 화면 노출

### 1.3 리소스

- 웹 서버는 웹 리소스를 관리하고 제공한다 → 정적파일, 요청에 따라 콘텐츠를 생산하는 프로그램이 될 수 있다. (동적 콘텐츠)

#### 1.3.1 미디어 타입

- 수천 가지 데이터 타입을 다루기 때문에, HTTP는 웹에서 전송되는 객체 각각에 신중하게 MIME 타입이라는 데이터 포맷 라벨을 붙인다.  
  - MIME (Multipurpose Internet Mail Extensions, 다목적 인터넷 메일 확장) → 긴 문장으로는 처음 알았다…  
  - 각기 다른 전자메일 시스템 사이에서 메시지가 오갈 때 겪는 문제점을 해결하기 위해 설계되었다.  
  - 웹 서버는 모든 HTTP 객체 데이터에 MIME 타입을 붙인다.

- 예시  
  - HTML 작성된 문서: `text/html`  
  - plain ASCII 텍스트: `text/plain`  
  - JPEG 이미지: `image/jpeg`  
  - GIF 이미지: `image/gif`  
  - 애플 퀵타임 동영상: `video/quicktime`

#### 1.3.3 URI

- 서버 리소스 이름은 통합 자원 식별자  
  - (uniform resource identifier) 혹은 URI  
  - URI는 인터넷의 운편물 주소 같은 것으로, 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있다.  
  - URI에는 두 가지가 있다. URL, URN

#### 1.3.3 URL

- 통합 자원 지시자(uniform resource locator, URL)는 리소스 식별자의 가장 흔한 형태다.  
- URL은 특정 서버의 한 리소스에 대한 구체적인 위치를 서술한다.

  
| **URL** | **설명** |
| --- | --- |
| http://www.oreilly.com/index.html | 오라일리 출판사 홈페이지의 URL |
| http://www.yahoo.com/images/logo.gif | 야후 웹 사이트 로고의 URL |
| http://www.joes-hardware.com/inventory-check.cgi/item=12731 | 물품 #12731의 재고가 있는지 확인하는 프로그램에 대한 URL |
| ftp://joetools:4u8f@ftp.joes-hardware.com/locking-pliers.gif | 비밀번호로 보호되는 FTP를 통해 locking-pliers.gif 이미지 파일에 접근하는 URL |

#### 1.3.4 URN

- URI의 두 번째 종류는 유니폼 리소스 이름(uniform resource name, URN)이다.  
- URN은 콘텐츠를 이루는 한 리소스에 대해 그 리소스의 위치에 영향 받지 않는 유일무이한 이름 역할을 한다.

### 1.4 트랜잭션

- 클라이언트가 웹 서버와 리소스를 주고 받기 위해 HTTP를 어떻게 사용하는지 자세하게 알아보면 아래와 같다.  
  - HTTP 메시지라고 불리는 정형화된 데이터 덩어리를 이용해 이뤄진다.

#### 1.4.1 메서드

- HTTP는 HTTP 메서드라고 불리는 여러 가지 종류 요청 명령을 지원한다.  
- 모든 HTTP 요청 메시지는 한 개의 메서드를 갖는다.  
- 흔히 쓰이는 HTTP 메서드 다섯 개를 열거하고 있다.  
  - GET, PUT, DELETE, POST, HEAD  
    - **개인적으로 느꼈을 때 REST API에서 사용하는 대표적인 4가지 메서드는 GET, POST, PUT, DELETE이다. (상황에 따라 PATCH도 추가로 사용된다.)**

#### 1.4.2 상태코드

- 모든 HTTP 응답 메시지는 상태 코드와 함께 반환된다.  
- 상태 코드는 클라이언트에게 요청이 성공했는지 아니면 추가 조치가 필요한지 알려주는 세 자리 숫자다.  
  - 200(정상), 302(리디렉션, 임시이동), 404(없음)

### 1.6 TCP커넥션

#### 1.6.1 TCP/IP

- HTTP는 애플리케이션 계층 프로토콜이다. HTTP 통신의 핵심적인 세부사항에 대해서 신경 쓰지 않는다.  
- 대중적이고 신뢰성 있는 인터넷 전송 프로토콜인 TCP/IP에 맡긴다.  
  - “오류 없는 데이터 전송” → TCP의 **체크섬 + ACK/재전송**  
  - “순서에 맞는 전달” → TCP의 **시퀀스 번호**  
  - “조각나지 않는 데이터 스트림” → TCP가 스트림 단위로 연결을 유지 (IP 단편화와 무관하게 상위 레벨에서 연속된 바이트 스트림 제공)

  
| 계층 | 프로토콜 / 구성요소 | 설명 |
| --- | --- | --- |
| 애플리케이션 계층 | HTTP | 웹 애플리케이션 통신 담당 |
| 전송 계층 | TCP | 신뢰성 있는 데이터 전송 보장 (순서, 무결성, 재전송) |
| 네트워크 계층 | IP | 패킷을 목적지까지 전달 (주소 지정, 라우팅) |
| 데이터 링크 계층 | 네트워크 인터페이스 | 네트워크 하드웨어와 상호작용, 프레임 단위 전송 |
| 물리 계층 | 물리적 네트워크 하드웨어 | 전기적/광학적 신호를 실제로 송수신 |

#### 1.6.2 접속, IP 주소 그리고 포트번호

- HTTP 클라이언트가 서버에 메시지를 전송할 수 있게 되기 전에, 인터넷 프로토콜 (IP) 주소와 포트 번호를 사용해 클라이언트 사이에 TCP/IP 커넥션을 맺어야 한다.  
- HTTP 80과 HTTPS 443만 일단 알고 있어도 충분 여기서는..  
  - 21 FTP, 22 SSH, 23 TELNET 는 알고 있으면 좋다.  
  - 53는 Router 53으로 AWS에서 쓰고 있는 것으로 기억하면 좋다.

## 웹 브라우저가 문서를 가져오는 과정

  
| 단계 | 설명 |
| --- | --- |
| (a) | 웹 브라우저는 서버의 URL에서 **호스트명**을 추출한다. |
| (b) | 웹 브라우저는 추출한 **호스트명을 IP 주소로 변환(DNS 조회)** 한다. |
| (c) | 웹 브라우저는 URL에서 **포트 번호**(있다면)를 추출한다. |
| (d) | 웹 브라우저는 웹 서버와 **TCP 커넥션**을 맺는다. |
| (e) | 웹 브라우저는 서버에 **HTTP 요청**을 보낸다. |
| (f) | 서버는 브라우저에 **HTTP 응답**을 돌려준다. |
| (g) | 커넥션이 닫히면, 브라우저는 **문서를 화면에 렌더링**한다. |

### 1.7 프로토콜 버전

- 책에서는 프로토콜 버전으로 0.9부터 2.0까지만 나와있지만 현재는 3.0까지 존재한다. (책이 14년에 나왔으므로..)  
- [inpa 블로그 - HTTP/3 통신 기술](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-HTTP-30-%ED%86%B5%EC%8B%A0-%EA%B8%B0%EC%88%A0-%EC%9D%B4%EC%A0%9C%EB%8A%94-%ED%99%95%EC%8B%A4%ED%9E%88-%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90)  
- [Wikipedia - HTTP/3](https://en.wikipedia.org/wiki/HTTP/3)


## 1.8 웹의 구성요소

### 1.8.1 프락시
- 웹 보안, 애플리케이션 통합, 성능 최적화를 위해 사용되는 **옵션 구성요소** (예: Nginx, HAProxy, CloudFront)
- 클라이언트와 서버 사이에 위치해 모든 HTTP 요청을 받아 서버로 전달한다.
- 주로 **보안 목적**으로 쓰이며, 신뢰할 수 있는 중개자 역할을 한다.
- 요청과 응답을 **필터링**할 수 있다. (예: SSL 종료, 접근 제어, 광고/악성 요청 차단)
- **효과**: 보안 강화, 트래픽 관리(로드밸런싱, 캐싱, 압축), 서비스 안정성 확보

---

### 1.8.2 캐시
- 캐시 프락시는 프락시의 한 형태로, 자주 요청되는 문서의 **사본을 저장**한다.
- 동일한 요청이 들어오면 서버 대신 캐시에서 응답한다.
- **효과**: 네트워크 비용 절감, 응답 속도 향상, 서버 부하 감소

---

### 1.8.3 게이트웨이
- 다른 서버들의 중개자로 동작하는 특별한 서버
- 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용한다.
- 언제나 스스로가 리소스를 갖고 있는 진짜 서버인 것처럼 요청을 다룬다.
  - 예: HTTP/FTP 게이트웨이 → FTP URI에 대한 HTTP 요청을 받아들여, FTP 프로토콜을 통해 문서를 가져온다.

---

### 1.8.4 터널
- 두 커넥션 사이에서 데이터를 열어보지 않고 그대로 전달하는 HTTP 애플리케이션
- 대표적인 예: 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송하여, **웹 트래픽만 허용하는 방화벽**을 통과시키는 방식
- HTTP/SSL 터널은 HTTP 요청을 받아 목적지 주소와 포트번호로 커넥션을 맺는다.

---

### 1.8.5 에이전트
- 사용자를 대신해 HTTP 요청을 만드는 클라이언트 프로그램
- 모든 웹 요청 애플리케이션은 HTTP 에이전트
  - 예: 구글봇, AI 관련 크롤러 (사람 개입 없이 콘텐츠를 가져옴)

---

## 1.9 시작의 끝
- 이 장에서는 HTTP가 **멀티미디어 전송 프로토콜**로서 수행하는 역할을 다뤘다.

⸻

📖 2025년 9월 25일 — 2장 URL과 리소스 정리

⸻

2. URL과 리소스

책에서는 길거리 주소, 버스 노선 번호, 은행 계좌 같은 예시를 들며, **이름 체계(표준)**가 존재하기 때문에 리소스를 쉽게 공유할 수 있다고 설명한다.
	•	URL은 인터넷의 리소스를 가리키는 표준 이름이다.
	•	URL의 문법: 여러 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지 이해해야 한다.
	•	상대 URI와 확장 URL: 여러 웹 클라이언트가 지원.
	•	URL의 인코딩과 문자 규칙
	•	공통 URL 스킴: 여러 인터넷 정보 시스템에 적용.
	•	URN: 기존 이름을 유지하면서도 객체를 다른 장소로 옮길 수 있게 해주는 확장 개념.

⸻

2.1 인터넷의 리소스 탐색하기
	•	URL은 브라우저가 정보를 찾는 데 필요한 리소스의 위치를 가리킨다.
	•	URL을 통해 사람과 애플리케이션은 인터넷상의 수십억 개 리소스를 찾고, 사용하며, 공유할 수 있다.
	•	URL은 HTTP뿐 아니라 다른 프로토콜을 통해서도 접근 가능하다.
	•	사용자는 브라우저에 URL을 입력하고, 브라우저는 뒤에서 적절한 프로토콜을 사용해 요청을 전송한다.

예시
	•	http://www.host/sasonal/index.html → 스킴 + 도메인 + 경로
	•	mailto:president@test.com → 메일 전송 프로토콜
	•	ftp://ftp.도메인/pub/test.xls → FTP 서버 파일
	•	rtsp://도메인:포트/cto_video → 스트리밍 영상

⸻

2.1.1 URL 이전의 암흑의 시대

웹과 URI가 등장하기 전에는 애플리케이션마다 다른 방식으로 리소스를 분류하고 접근해야 했다.
	•	현재: URL/URI를 통해 통합된 방식으로 접근
	•	과거: 서비스별 독자적 접근 방식
	•	FTP: 호스트명 + 포트 + 디렉토리 구조 필요
	•	Usenet 뉴스 그룹: 그룹명 + 기사 ID
	•	Telnet: 특정 포트 접속 후 커맨드 입력
	•	로컬 DB: 쿼리나 고유 키 필요

⸻

2.2 URL 컴포넌트

| **컴포넌트** | **설명** | **기본값** |
|--------------|----------|------------|
| **스킴** | 리소스를 가져오기 위한 프로토콜 | 없음 |
| **사용자 이름** | 리소스 접근 시 필요한 사용자 이름 | anonymous |
| **비밀번호** | 사용자 이름과 함께 쓰이는 인증 수단 (거의 사용 안 함) | 없음 |
| **호스트** | 리소스를 가진 장비의 이름이나 IP 주소 | 없음 |
| **포트** | 서버가 열어둔 네트워크 포트 | 스킴에 따라 다름 |
| **경로** | 서버 내 리소스 위치 | 없음 |
| **파라미터** | 리소스에 전달하는 이름/값 쌍의 매개 변수 | 없음 |
| **질의어(Query)** | 데이터베이스 질의 등 요청 시 전달되는 문자열 | 없음 |
| **프래그먼트** | 리소스 내부 특정 위치 지정 (#anchor) | 없음 |


예시
	•	사용자 이름/비밀번호: ftp://username:password@ftp.example.com/file.txt
	•	파라미터: http://example.com/content;lang=ko;version=2
	•	질의어: https://www.google.com/search?q=nextjs+seo&hl=ko

⸻

2.2.1 URL 파라미터 (;param=value)
	•	의미: 리소스 경로에 추가 속성을 전달하는 방식
	•	등장 배경: 쿼리스트링(?)이나 쿠키가 보편화되기 전, HTTP 초창기에 사용됨
	
  •	사례
	•	리소스 옵션 지정: http://example.com/index.html;lang=ko;version=2
	•	세션 식별자 전달: http://example.com/app/main;jsessionid=1234567890ABCDEF
	
  •	현재
	•	거의 사용되지 않음
	•	RESTful API, Query String, Header로 대체
	•	레거시 Java 웹 서버(JSP/Servlet)에서 ;jsessionid 형태로 가끔 등장

⸻

2.3 단축 URL
	•	상대 URL을 사용하면 리소스를 간결하게 기술 가능.
	•	일부 브라우저/클라이언트는 사용자가 입력한 URL 일부를 기반으로 나머지를 자동 완성하기도 함.

⸻

2.3.1 상대 URL

1) 상대 URL (Relative URL)
	•	문서 내에서 ./hammers.html처럼 간단히 표현
	•	장점: 문서를 다른 서버/디렉토리로 옮겨도 상대 경로는 그대로 유지

예시:

<a href="./hammers.html">Hammers</a>

	•	기준(Base URL): http://www.joes-hardware.com/tools.html
	•	상대 URL: ./hammers.html
	•	절대 URL: http://www.joes-hardware.com/hammers.html

⸻

2) 기저 URL (Base URL)

상대 URL을 해석할 때 기준이 되는 URL.
	•	HTML 문서 자체 URL
	•	<base> 태그로 명시
	•	리소스에서 암시적으로 제공되는 경우

⸻

3) 기저 URL이 없는 경우
	•	문서가 로컬 파일로만 제공되는 경우
	•	상대 URL 해석 불가 → 불완전 상태

⸻

4) 상대 경로 해석 규칙
	•	./, ../ 문법을 적용해 절대 경로로 변환

	•	예시:
	•	기저 URL: http://example.com/dir/tools.html
	•	상대 URL: ../images/icon.png
	•	절대 URL: http://example.com/images/icon.png

⸻

📖 2025년 9월 26일 — 2.4 안전하지 않은 문자 & 2.5 스킴 정리

⸻

## 2.4 안전하지 않은 문자

* URL은 잘 호환되도록 설계되었다.
* URL은 인터넷에 있는 모든 리소스가 여러 프로토콜을 통해서 전달될 수 있도록, 각 리소스에 유일한 이름을 지을 수 있게 설계되었다.
* SMTP(메일 프로토콜)는 특정 문자를 제거할 수도 있는 전송 방식을 사용한다.
* 문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락한다.
* 이스케이프라는 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였다.

### 2.4.1 URL 문자 집합

* 컴퓨터 시스템의 기본 문자 집합은 보통 영어 중심으로 설정되어 있다.
* 7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현한다.
* URL이 특정 이진 데이터를 포함해야 하는 경우도 있다. 이를 위해 이스케이프 문자열을 쓸 수 있게 설계하였다.

### 2.4.2 인코딩 체계

* 안전한 문자 집합을 이용하는 경우 한계를 넘기 위해, URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다.

---

## 인코딩된 문자 예

| **문자**    | **ASCII 코드** | **URL의 예**                                             |
| --------- | ------------ | ------------------------------------------------------ |
| `~`       | 126 (0x7E)   | `http://www.joes-hardware.com/%7Ejoe`                  |
| 빈 문자 (공백) | 32 (0x20)    | `http://www.joes-hardware.com/more%20tools.html`       |
| `%`       | 37 (0x25)    | `http://www.joes-hardware.com/100%25satisfaction.html` |

---

### 2.4.3 문자 제한

* 몇몇 문자는 URL 내에서 특별한 의미로 **예약(reserved)** 되어 있다. 예: `%`, `$`, `+`, `@` 등.
* 또한 US-ASCII의 출력 가능한 문자 집합에 포함되지 않는 문자는 직접 사용할 수 없다.

### 2.4.4 좀 더 알아보기 (URL 인코딩 핵심)

* 일부 특수문자는 URL에 직접 써도 동작할 수 있으나, 애플리케이션·브라우저마다 해석 방식이 달라 **호환성 문제가 발생**할 수 있다.
* **가장 안전한 방법은 모든 안전하지 않은 문자를 표준대로 인코딩하는 것**.

---

## 2.5 스킴의 바다

### 주요 URL 스킴 정리

| **스킴**          | **설명**                                 | **기본 포트** | **예시**                                                 |
| --------------- | -------------------------------------- | --------- | ------------------------------------------------------ |
| **http**        | 하이퍼텍스트 전송 프로토콜. 웹 문서 전송에 사용.           | 80        | `http://www.joes-hardware.com/index.html`              |
| **https**       | 보안 전송(SSL/TLS). HTTP를 암호화하여 안전한 통신 제공. | 443       | `https://www.joes-hardware.com/secure.html`            |
| **mailto**      | 이메일 주소를 가리킴. 이메일 클라이언트를 호출.            | 없음        | `mailto:joe@joes-hardware.com`                         |
| **ftp**         | 파일 전송 프로토콜. FTP 서버에서 파일 업/다운로드.        | 21        | `ftp://anonymous@joes-hardware.com/pub/gnu`            |
| **rtsp, rtspu** | 실시간 스트리밍 프로토콜. 미디어 스트리밍 전송.            | 554       | `rtsp://www.joes-hardware.com:554/interview.cto_video` |
| **file**        | 로컬 파일 경로. OS 파일 시스템 내 자원에 접근.          | 없음        | `file:///C:/OFFICE/SC/policies/casual-fridays.doc`     |
| **news**        | 뉴스 그룹 기사에 접근. (Usenet 기반)              | 없음        | `news:comp.infosystems.www.servers.unix`               |
| **telnet**      | 원격 로그인 세션. 원격 서버에 접속해 터미널 사용. (보안 취약)  | 23        | `telnet://slurp.webhound@joes-hardware.com/`           |
| **tel**         | 전화 링크 (모바일에서 사용) -> 책에서는 없었지만 추가     | 핸드폰 내 사용  | `tel:010-1234-5678`                                    |

---

⸻
